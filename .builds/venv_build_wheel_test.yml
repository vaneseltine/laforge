image: archlinux
environment:
  PATH: "${PATH}:$HOME/.local/bin"
secrets:
  - 2b416998-c1cc-496b-8365-2da512b3fc43
packages:
  - python
  - python-pip
  - python-setuptools
  - python-numpy
sources:
  - https://git.sr.ht/~matvan/laforge
tasks:
  - venv_build: |
        cat ~/.buildenv
        cd laforge
        python -m venv .venv
        source ./.venv/bin/activate
        python -m pip install -q --upgrade pip wheel setuptools
        python -m pip freeze
        python setup.py bdist_wheel
  - install: |
        deactivate
        python -m pip install --find-links=laforge/dist laforge>0.1.6
        python -m pip freeze
  - invoke: |
        cd ~
        python -c "import laforge;print(laforge.__version__)"
        python -m laforge --version
        laforge --version
        laforge consult
